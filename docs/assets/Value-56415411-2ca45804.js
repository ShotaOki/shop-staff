import{h as M}from"./index-58060d13.js";import{b as V,y as R,d as C,z as J,i as I}from"./utils-f2d0253a-570d2917.js";import{S as Q}from"./dataConstants-8e079f60-a2a46658.js";import{c as W,u as X}from"./_commonjsHelpers-1d681858-0cf2a93b.js";import{c as Z,p as x}from"./time-051aeed0-3f16b7f0.js";import{D as P}from"./constants-ebd051c2-d612ae6c.js";var q=globalThis&&globalThis.__spreadArrays||function(){for(var n=0,e=0,a=arguments.length;e<a;e++)n+=arguments[e].length;for(var o=Array(n),i=0,e=0;e<a;e++)for(var s=arguments[e],d=0,g=s.length;d<g;d++,i++)o[i]=s[d];return o},$=V(function(n){return n.x}),dr=function(n,e,a){a===void 0&&(a=!0);var o=I(e)?new Date(e.start):new Date(Date.now()-x(e.duration)),i=I(e)?new Date(e.end):new Date;if(n.length===0)return[];if(o.getTime()>n[n.length-1].x)return[];if(i.getTime()<n[0].x)return[];var s=Math.max($.left(n,o)-(a?1:0),0),d=Math.min($.right(n,i)-(a?0:1),n.length-1);return n.slice(s,d+1)},K=function(n,e){if(n.length===0)return[];if(e.getTime()<n[0].x)return[];var a=Math.min($.right(n,e)-1,n.length-1);return n.slice(0,a+1)},O=function(n){return function(e,a){return e.point==null&&a.point==null?0:e.point==null?-1:a.point==null?1:n(e.point)===n(a.point)?0:n(a.point)>n(e.point)?1:-1}},H=function(n,e,a,o){var i=$.left(n,e),s=n[i-1],d=n[i];return s&&s.x===e.getTime()?s:d&&d.x===e.getTime()?d:a===P.RIGHT?d&&(o==null||d.x-e.getTime()<=o)?d:void 0:a===P.LEFT?s&&(o==null||e.getTime()-s.x<=o)?s:void 0:(!s||!d)&&s||d},lr=function(n){var e=n.viewport,a=n.dataStreams,o=n.selectedDate,i=n.allowMultipleDates,s=n.dataAlignment,d=n.maxDurationFromDate,g=a.map(function(y){return{streamId:y.id,dataPoints:K(y.data,e.end)}}),c=o.getTime(),p=g.map(function(y){var E=y.streamId,D=y.dataPoints;return{streamId:E,point:H(D,o,s,d)}});if(i)return p;var A=function(y){return Math.abs(y.x-c)},h=p.sort(O(A));if(h.length===0)return[];var S=h[h.length-1].point;return S==null?h:h.filter(function(y){return y.point&&y.point.x===S.x})},k=function(n,e){return n==null?e:n.severity==null&&e.severity==null?n:n.severity==null?e:e.severity==null||n.severity<=e.severity?n:e},b=function(n){return n.reduce(k,void 0)},L=function(n,e){var a=n.dataStreamIds;return a==null?!0:a.includes(e)},j=function(n){var e=n.date,a=n.dataStream,o=n.dataStreams,i=n.thresholds,s=a.associatedStreams!=null?a.associatedStreams.filter(function(p){var A=p.type;return A===Q.ALARM}).map(function(p){var A=p.id;return A}):[],d=function(p){return s.includes(p.id)},g=o.filter(d),c=g.map(function(p){var A=i.filter(function(S){return L(S,p.id)}),h=H(p.data,e,P.LEFT);return h!=null?R(h.y,A):void 0}).filter(C);return c},pr=function(n){var e=n.value,a=n.date,o=n.thresholds,i=n.dataStreams,s=n.dataStream,d=o.filter(function(p){return L(p,s.id)}),g=e!=null?R(e,d):void 0,c=j({date:a,dataStream:s,dataStreams:i,thresholds:o});return b(q([g],c).filter(C))},rr=W(function(n,e){Object.defineProperty(e,"__esModule",{value:!0});function a(r){return typeof r=="object"&&!("toString"in r)?Object.prototype.toString.call(r).slice(8,-1):r}var o=typeof process=="object"&&!0;function i(r,t){if(!r)throw o?new Error("Invariant failed"):new Error(t())}e.invariant=i;var s=Object.prototype.hasOwnProperty,d=Array.prototype.splice,g=Object.prototype.toString;function c(r){return g.call(r).slice(8,-1)}var p=Object.assign||function(r,t){return A(t).forEach(function(u){s.call(t,u)&&(r[u]=t[u])}),r},A=typeof Object.getOwnPropertySymbols=="function"?function(r){return Object.keys(r).concat(Object.getOwnPropertySymbols(r))}:function(r){return Object.keys(r)};function h(r){return Array.isArray(r)?p(r.constructor(r.length),r):c(r)==="Map"?new Map(r):c(r)==="Set"?new Set(r):r&&typeof r=="object"?p(Object.create(Object.getPrototypeOf(r)),r):r}var S=function(){function r(){this.commands=p({},y),this.update=this.update.bind(this),this.update.extend=this.extend=this.extend.bind(this),this.update.isEquals=function(t,u){return t===u},this.update.newContext=function(){return new r().update}}return Object.defineProperty(r.prototype,"isEquals",{get:function(){return this.update.isEquals},set:function(t){this.update.isEquals=t},enumerable:!0,configurable:!0}),r.prototype.extend=function(t,u){this.commands[t]=u},r.prototype.update=function(t,u){var l=this,f=typeof u=="function"?{$apply:u}:u;Array.isArray(t)&&Array.isArray(f)||i(!Array.isArray(f),function(){return"update(): You provided an invalid spec to update(). The spec may not contain an array except as the value of $set, $push, $unshift, $splice or any custom command allowing an array value."}),i(typeof f=="object"&&f!==null,function(){return"update(): You provided an invalid spec to update(). The spec and every included key path must be plain objects containing one of the "+("following commands: "+Object.keys(l.commands).join(", ")+".")});var m=t;return A(f).forEach(function(v){if(s.call(l.commands,v)){var G=t===m;m=l.commands[v](f[v],m,f,t),G&&l.isEquals(m,t)&&(m=t)}else{var w=c(t)==="Map"?l.update(t.get(v),f[v]):l.update(t[v],f[v]),Y=c(m)==="Map"?m.get(v):m[v];(!l.isEquals(w,Y)||typeof w>"u"&&!s.call(t,v))&&(m===t&&(m=h(t)),c(m)==="Map"?m.set(v,w):m[v]=w)}}),m},r}();e.Context=S;var y={$push:function(r,t,u){return D(t,u,"$push"),r.length?t.concat(r):t},$unshift:function(r,t,u){return D(t,u,"$unshift"),r.length?r.concat(t):t},$splice:function(r,t,u,l){return U(t,u),r.forEach(function(f){_(f),t===l&&f.length&&(t=h(l)),d.apply(t,f)}),t},$set:function(r,t,u){return F(u),r},$toggle:function(r,t){T(r,"$toggle");var u=r.length?h(t):t;return r.forEach(function(l){u[l]=!t[l]}),u},$unset:function(r,t,u,l){return T(r,"$unset"),r.forEach(function(f){Object.hasOwnProperty.call(t,f)&&(t===l&&(t=h(l)),delete t[f])}),t},$add:function(r,t,u,l){return N(t,"$add"),T(r,"$add"),c(t)==="Map"?r.forEach(function(f){var m=f[0],v=f[1];t===l&&t.get(m)!==v&&(t=h(l)),t.set(m,v)}):r.forEach(function(f){t===l&&!t.has(f)&&(t=h(l)),t.add(f)}),t},$remove:function(r,t,u,l){return N(t,"$remove"),T(r,"$remove"),r.forEach(function(f){t===l&&t.has(f)&&(t=h(l)),t.delete(f)}),t},$merge:function(r,t,u,l){return z(t,r),A(r).forEach(function(f){r[f]!==t[f]&&(t===l&&(t=h(l)),t[f]=r[f])}),t},$apply:function(r,t){return B(r),r(t)}},E=new S;e.isEquals=E.update.isEquals,e.extend=E.extend,e.default=E.update,e.default.default=n.exports=p(e.default,e);function D(r,t,u){i(Array.isArray(r),function(){return"update(): expected target of "+a(u)+" to be an array; got "+a(r)+"."}),T(t[u],u)}function T(r,t){i(Array.isArray(r),function(){return"update(): expected spec of "+a(t)+" to be an array; got "+a(r)+". Did you forget to wrap your parameter in an array?"})}function U(r,t){i(Array.isArray(r),function(){return"Expected $splice target to be an array; got "+a(r)}),_(t.$splice)}function _(r){i(Array.isArray(r),function(){return"update(): expected spec of $splice to be an array of arrays; got "+a(r)+". Did you forget to wrap your parameters in an array?"})}function B(r){i(typeof r=="function",function(){return"update(): expected spec of $apply to be a function; got "+a(r)+"."})}function F(r){i(Object.keys(r).length===1,function(){return"Cannot have more than one key in an object with $set"})}function z(r,t){i(t&&typeof t=="object",function(){return"update(): $merge expects a spec of type 'object'; got "+a(t)}),i(r&&typeof r=="object",function(){return"update(): $merge expects a target of type 'object'; got "+a(r)})}function N(r,t){var u=c(r);i(u==="Map"||u==="Set",function(){return"update(): "+a(t)+" expects a target of type Set or Map; got "+a(u)})}}),tr=X(rr);function nr(n){return n.replace(/_/g," ").toLowerCase()}var cr=function(n,e){if(n===0||!e)return"raw data";var a=Z(n),o=a.day,i=a.hour,s=a.minute,d=a.seconds,g=function(p){return p>1?"s":""},c=nr(e);return o!==0?o+" day"+g(o)+" "+c:i!==0?i+" hour"+g(i)+" "+c:s!==0?s+" minute"+g(s)+" "+c:d!==0?d+" second"+g(d)+" "+c:"N/A"},hr=function(n,e,a){var o,i=n.findIndex(function(s){return s.id===a});return i>=0?tr(n,(o={},o[i]={$set:{id:a,name:e}},o)):q(n,[{name:e,id:a}])},er="-",mr="No properties or alarms",vr="This widget doesn't have any properties or alarms.",gr="No data",yr="There's no data to display for this time range.",Ar=function(n){var e=n.isEnabled,a=e===void 0?!0:e,o=n.value,i=n.unit,s=n.precision;return!a||o==null?M("span",{"data-testid":"no-value-present"},er):typeof o=="number"?[J(o,s),i&&M("span",{class:"unit"}," ",i)]:[String(o),i&&M("span",{class:"unit"}," ",i)]};export{gr as N,Ar as V,lr as a,pr as b,yr as c,mr as d,vr as e,dr as f,cr as g,H as h,O as s,hr as u};
