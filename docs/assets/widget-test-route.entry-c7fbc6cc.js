import{h as C,r as sr}from"./index-d9c51ec4.js";import{D as J,S as T}from"./dataConstants-8e079f60-a2a46658.js";import{c as dr}from"./_commonjsHelpers-1d681858-0cf2a93b.js";import{a as or}from"./time-051aeed0-3f16b7f0.js";import{L as fr}from"./constants-ebd051c2-d612ae6c.js";import{A as ur}from"./dataTypes-aaacf3dd-f0dc34ae.js";var A=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,n=0,d=arguments.length;n<d;n++)e+=arguments[n].length;for(var u=Array(e),y=0,n=0;n<d;n++)for(var h=arguments[n],o=0,p=h.length;o<p;o++,y++)u[y]=h[o];return u},m=new Date(2e3,0,0),tr=new Date(2e3,0,1),v=tr.getTime()-m.getTime(),N=60,b="OK",M="ALARM",cr=function(){return[{x:m.getTime()+v/5,y:N/5},{x:m.getTime()+v*2/5,y:N/4},{x:m.getTime()+v*3/5,y:N},{x:m.getTime()+v*4/5,y:N*2}]},lr=function(){return[{x:m.getTime()+v/5,y:b},{x:m.getTime()+v*2/5,y:b},{x:m.getTime()+v*3/5,y:b},{x:m.getTime()+v*4/5,y:M}]},gr=function(){return[{x:m.getTime()+v/5,y:b},{x:m.getTime()+v*2/5,y:b},{x:m.getTime()+v*3/5,y:M},{x:m.getTime()+v*4/5,y:M}]},E={dataType:J.STRING,resolution:0,id:"speeding-alarm",color:"red",name:"speeding alarm",streamType:T.ALARM},R={dataType:J.STRING,resolution:0,id:"oil-change-alarm",color:"orange",name:"oil change alarm",streamType:T.ALARM},P={dataType:J.NUMBER,resolution:0,id:"stream-with-alarms",color:"black",name:"mph",associatedStreams:[{id:E.id,type:T.ALARM},{id:R.id,type:T.ALARM}]};P.id,P.dataType,ur.AVERAGE,cr(),or,E.id,T.ALARM,E.id,T.ALARM;E.id,T.ALARM,E.dataType,lr();R.id,R.dataType,gr(),T.ALARM;var X={start:m,end:tr},mr={height:500,width:500},yr={position:fr.RIGHT,width:200,legendLabels:{title:"Number of data points"}},hr=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(n){return"%"+n.charCodeAt(0).toString(16).toUpperCase()})},ar="%[a-f0-9]{2}",$=new RegExp("("+ar+")|([^%]+?)","gi"),K=new RegExp("("+ar+")+","gi");function L(e,n){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;n=n||1;var d=e.slice(0,n),u=e.slice(n);return Array.prototype.concat.call([],L(d),L(u))}function pr(e){try{return decodeURIComponent(e)}catch{for(var n=e.match($)||[],d=1;d<n.length;d++)e=L(n,d).join(""),n=e.match($)||[];return e}}function vr(e){for(var n={"%FE%FF":"��","%FF%FE":"��"},d=K.exec(e);d;){try{n[d[0]]=decodeURIComponent(d[0])}catch{var u=pr(d[0]);u!==d[0]&&(n[d[0]]=u)}d=K.exec(e)}n["%C2"]="�";for(var y=Object.keys(n),h=0;h<y.length;h++){var o=y[h];e=e.replace(new RegExp(o,"g"),n[o])}return e}var Sr=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return vr(e)}},Q=function(e,n){if(!(typeof e=="string"&&typeof n=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(n==="")return[e];var d=e.indexOf(n);return d===-1?[e]:[e.slice(0,d),e.slice(d+n.length)]},Or=function(e,n){for(var d={},u=Object.keys(e),y=Array.isArray(n),h=0;h<u.length;h++){var o=u[h],p=e[o];(y?n.indexOf(o)!==-1:n(o,p,e))&&(d[o]=p)}return d},wr=dr(function(e,n){var d=function(r){return r==null};function u(r){switch(r.arrayFormat){case"index":return function(t){return function(i,a){var s=i.length;return a===void 0||r.skipNull&&a===null||r.skipEmptyString&&a===""?i:a===null?A(i,[[o(t,r),"[",s,"]"].join("")]):A(i,[[o(t,r),"[",o(s,r),"]=",o(a,r)].join("")])}};case"bracket":return function(t){return function(i,a){return a===void 0||r.skipNull&&a===null||r.skipEmptyString&&a===""?i:a===null?A(i,[[o(t,r),"[]"].join("")]):A(i,[[o(t,r),"[]=",o(a,r)].join("")])}};case"comma":case"separator":return function(t){return function(i,a){return a==null||a.length===0?i:i.length===0?[[o(t,r),"=",o(a,r)].join("")]:[[i,o(a,r)].join(r.arrayFormatSeparator)]}};default:return function(t){return function(i,a){return a===void 0||r.skipNull&&a===null||r.skipEmptyString&&a===""?i:a===null?A(i,[o(t,r)]):A(i,[[o(t,r),"=",o(a,r)].join("")])}}}}function y(r){var t;switch(r.arrayFormat){case"index":return function(i,a,s){if(t=/\[(\d*)\]$/.exec(i),i=i.replace(/\[\d*\]$/,""),!t){s[i]=a;return}s[i]===void 0&&(s[i]={}),s[i][t[1]]=a};case"bracket":return function(i,a,s){if(t=/(\[\])$/.exec(i),i=i.replace(/\[\]$/,""),!t){s[i]=a;return}if(s[i]===void 0){s[i]=[a];return}s[i]=[].concat(s[i],a)};case"comma":case"separator":return function(i,a,s){var l=typeof a=="string"&&a.includes(r.arrayFormatSeparator),c=typeof a=="string"&&!l&&p(a,r).includes(r.arrayFormatSeparator);a=c?p(a,r):a;var S=l||c?a.split(r.arrayFormatSeparator).map(function(O){return p(O,r)}):a===null?a:p(a,r);s[i]=S};default:return function(i,a,s){if(s[i]===void 0){s[i]=a;return}s[i]=[].concat(s[i],a)}}}function h(r){if(typeof r!="string"||r.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function o(r,t){return t.encode?t.strict?hr(r):encodeURIComponent(r):r}function p(r,t){return t.decode?Sr(r):r}function H(r){return Array.isArray(r)?r.sort():typeof r=="object"?H(Object.keys(r)).sort(function(t,i){return Number(t)-Number(i)}).map(function(t){return r[t]}):r}function _(r){var t=r.indexOf("#");return t!==-1&&(r=r.slice(0,t)),r}function ir(r){var t="",i=r.indexOf("#");return i!==-1&&(t=r.slice(i)),t}function q(r){r=_(r);var t=r.indexOf("?");return t===-1?"":r.slice(t+1)}function B(r,t){return t.parseNumbers&&!Number.isNaN(Number(r))&&typeof r=="string"&&r.trim()!==""?r=Number(r):t.parseBooleans&&r!==null&&(r.toLowerCase()==="true"||r.toLowerCase()==="false")&&(r=r.toLowerCase()==="true"),r}function G(r,t){t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t),h(t.arrayFormatSeparator);var i=y(t),a=Object.create(null);if(typeof r!="string"||(r=r.trim().replace(/^[?#&]/,""),!r))return a;for(var s=0,l=r.split("&");s<l.length;s++){var c=l[s];if(c!==""){var S=Q(t.decode?c.replace(/\+/g," "):c,"="),O=S[0],f=S[1];f=f===void 0?null:["comma","separator"].includes(t.arrayFormat)?f:p(f,t),i(p(O,t),f,a)}}for(var w=0,V=Object.keys(a);w<V.length;w++){var O=V[w],f=a[O];if(typeof f=="object"&&f!==null)for(var x=0,W=Object.keys(f);x<W.length;x++){var z=W[x];f[z]=B(f[z],t)}else a[O]=B(f,t)}return t.sort===!1?a:(t.sort===!0?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(function(j,D){var F=a[D];return F&&typeof F=="object"&&!Array.isArray(F)?j[D]=H(F):j[D]=F,j},Object.create(null))}n.extract=q,n.parse=G,n.stringify=function(r,t){if(!r)return"";t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t),h(t.arrayFormatSeparator);for(var i=function(f){return t.skipNull&&d(r[f])||t.skipEmptyString&&r[f]===""},a=u(t),s={},l=0,c=Object.keys(r);l<c.length;l++){var S=c[l];i(S)||(s[S]=r[S])}var O=Object.keys(s);return t.sort!==!1&&O.sort(t.sort),O.map(function(f){var w=r[f];return w===void 0?"":w===null?o(f,t):Array.isArray(w)?w.reduce(a(f),[]).join("&"):o(f,t)+"="+o(w,t)}).filter(function(f){return f.length>0}).join("&")},n.parseUrl=function(r,t){t=Object.assign({decode:!0},t);var i=Q(r,"#"),a=i[0],s=i[1];return Object.assign({url:a.split("?")[0]||"",query:G(q(r),t)},t&&t.parseFragmentIdentifier&&s?{fragmentIdentifier:p(s,t)}:{})},n.stringifyUrl=function(r,t){t=Object.assign({encode:!0,strict:!0},t);var i=_(r.url).split("?")[0]||"",a=n.extract(r.url),s=n.parse(a,{sort:!1}),l=Object.assign(s,r.query),c=n.stringify(l,t);c&&(c="?"+c);var S=ir(r.url);return r.fragmentIdentifier&&(S="#"+o(r.fragmentIdentifier,t)),""+i+c+S},n.pick=function(r,t,i){i=Object.assign({parseFragmentIdentifier:!0},i);var a=n.parseUrl(r,i),s=a.url,l=a.query,c=a.fragmentIdentifier;return n.stringifyUrl({url:s,query:Or(l,t),fragmentIdentifier:c},i)},n.exclude=function(r,t,i){var a=Array.isArray(t)?function(s){return!t.includes(s)}:function(s,l){return!t(s,l)};return n.pick(r,a,i)}}),Tr=wr.parse,I=function(e){return e==="true"},Ar=function(e){var n=JSON.parse(e),d=n.x,u=function(y){return Object.assign(Object.assign({},y),{value:new Date(y.value)})};return Object.assign(Object.assign({},n),{x:d!=null?d.map(u):void 0})},Z=function(e){return Object.assign(Object.assign({},e),{data:e.data.map(function(n){return{x:Number(n.x),y:n.y}})})},Fr=function(){var e=Tr(window.location.search);return{alarms:e.alarms?JSON.parse(e.alarms):void 0,width:e.width?JSON.parse(e.width):void 0,axis:e.axis?JSON.parse(e.axis):void 0,height:e.height?JSON.parse(e.height):void 0,duration:e.duration?JSON.parse(e.duration):void 0,errMsg:e.errMsg,gestures:e.gestures!=null?I(e.gestures):!0,delayBeforeDataLoads:e.delayBeforeDataLoads!=null?JSON.parse(e.delayBeforeDataLoads):0,dataStreamInfos:e.dataStreamInfos!=null?JSON.parse(e.dataStreamInfos):[],tableColumns:e.tableColumns!=null?JSON.parse(e.tableColumns):[],legend:e.legend!=null?JSON.parse(e.legend):yr,messageOverrides:e.messageOverrides!=null?JSON.parse(e.messageOverrides):void 0,componentTag:e.componentTag!=null?e.componentTag:"iot-app-kit-vis-line-chart",displayInfoNames:e.displayInfoNames?I(e.displayInfoNames):!1,annotations:e.annotations!=null?Ar(e.annotations):void 0,isEditing:e.isEditing!=null?I(e.isEditing):!1,hasError:e.hasError!=null?I(e.hasError):!1,dataStreams:e.dataStreams!=null?JSON.parse(e.dataStreams).map(Z):[],asyncDataStreams:e.asyncDataStreams!=null?JSON.parse(e.asyncDataStreams).map(Z):[],viewportStart:e.viewportStart!=null?new Date(e.viewportStart):new Date(2e3,0,0),viewportEnd:e.viewportEnd!=null?new Date(e.viewportEnd):new Date(2e3,0,1)}},br=700,Er=400,g=Fr(),Nr=g.alarms,Ir=g.messageOverrides,Y=g.width,U=Y===void 0?br:Y,k=g.height,nr=k===void 0?Er:k,xr=g.axis,jr=g.componentTag,Dr=g.annotations,Cr=g.viewportStart,Mr=g.viewportEnd,rr=g.duration,Rr=g.isEditing,Lr=g.dataStreams,Ur=g.gestures,Jr=g.legend,Hr=g.tableColumns,_r=function(e){if(typeof e!="string")return Object.assign(Object.assign({},mr),{width:U,height:nr})},er=function(e){return typeof e=="string"?e:e+"px"},Pr=function(){function e(n){var d=this;sr(this,n),this.viewport=X,this.dataStreamInfos=[],this.component=jr,this.setViewPort=function(u){d.viewport=u}}return e.prototype.onWidgetUpdated=function(n){var d=n.detail;d.dataStreamInfo&&(this.dataStreamInfos=d.dataStreamInfo)},e.prototype.render=function(){var n=Object.assign(Object.assign({},X),{start:Cr,end:Mr,duration:rr,group:"some-viewport-group"});return rr!=null&&(delete n.start,delete n.end),C("div",{style:{width:er(U),height:er(nr)}},C(this.component,{widgetId:"some-widget-id",dataStreams:Lr,isEditing:Rr,alarms:Nr,viewport:n,setViewport:this.setViewPort,legend:Jr,size:_r(U),axis:xr,tableColumns:Hr,annotations:Dr,gestures:Ur,messageOverrides:Ir,invalidTagErrorHeader:"invalidComponentTag.header",invalidTagErrorSubheader:"invalidComponentTag.subheader",liveModeOnly:"invalidWidgetForHistoricalData.content"}),C("iot-app-kit-vis-webgl-context",null))},e}();export{Pr as widget_test_route};
